define("mockup-patterns-contentloader",["jquery","pat-base","pat-logger","pat-registry","mockup-utils","underscore"],function(t,e,o,n,i,l){"use strict";var r=o.getLogger("pat-contentloader");return e.extend({name:"contentloader",trigger:".pat-contentloader",parser:"mockup",defaults:{url:null,content:null,trigger:"click",target:null,template:null,dataType:"html"},init:function(){var t=this;"el"===t.options.url&&"A"===t.$el[0].tagName&&(t.options.url=t.$el.attr("href")),"immediate"===t.options.trigger?t._load():t.$el.on(t.options.trigger,function(e){e.preventDefault(),t._load()})},_load:function(){var t=this;t.$el.addClass("loading-content"),t.options.url?t.loadRemote():t.loadLocal()},loadRemote:function(){var e=this;t.ajax({url:e.options.url,dataType:e.options.dataType,success:function(o){var n;if("html"===e.options.dataType)-1!==o.indexOf("<html")&&(o=i.parseBodyTag(o)),n=t("<div>"+o+"</div>");else if(-1!==e.options.dataType.indexOf("json")){o.constructor===Array&&1===o.length&&(o=o[0]);try{n=t(l.template(e.options.template)(o))}catch(t){return void r.warn("error rendering template. pat-contentloader will not work")}}null!==e.options.content&&(n=n.find(e.options.content)),e.loadLocal(n),e.$el.removeClass("loading-content")},error:function(){e.$el.addClass("content-load-error")}})},loadLocal:function(e){var o=this;if(e||null!==o.options.content){var i=o.$el;null===o.options.target||0!==(i=t(o.options.target)).size()?(e||(e=t(o.options.content).clone()),e.show(),i.replaceWith(e),n.scan(e),o.$el.removeClass("loading-content")):r.warn("No target nodes found")}else r.warn("No selector configured")}})}),define("collectionfilter",["jquery","pat-base","mockup-patterns-contentloader"],function(t,e,o){return e.extend({name:"collectionfilter",trigger:".pat-collectionfilter",parser:"mockup",contentloader:o,defaults:{collectionUUID:"",collectionURL:"",reloadURL:"",contentSelector:"#content-core"},init:function(){if(this.$el.unbind("collectionfilter:reload"),this.$el.on("collectionfilter:reload",function(t,e){e.noReloadSearch&&this.$el.hasClass("collectionSearch")||e.collectionUUID===this.options.collectionUUID&&this.reload(e.targetFilterURL)}.bind(this)),this.$el.hasClass("collectionSearch")){t('button[type="submit"]',this.$el).hide(),t("form",this.$el).on("submit",function(t){t.preventDefault()});var e;t('input[name="SearchableText"]',this.$el).on("keyup",function(o){clearTimeout(e),e=setTimeout(function(){var e=t(o.target).data("url"),n=encodeURIComponent(t(o.target).val());e+="&"+t(o.target).attr("name")+"="+n,t(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:e,noReloadSearch:!0}),this.reloadCollection(e)}.bind(this),500)}.bind(this))}t("a.filteritem",this.$el).on("click",function(e){e.stopPropagation(),e.preventDefault();var o=t(e.target).closest("a").attr("href");t(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:o}),this.reloadCollection(o)}.bind(this)),t("input.filteritem",this.$el).on("change",function(e){var o=t(e.target).data("url");t(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:o}),this.reloadCollection(o)}.bind(this)),t("select.filteritem",this.$el).on("change",function(e){var o=t("option:selected",e.target),n=t(o).data("url");t(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:n}),this.reloadCollection(n)}.bind(this))},reload:function(t){var e=this.options.reloadURL,o=e.split("?"),n=o[1]||[],i=t.split("?")[1]||[],l=[].concat(n,i).join("&");e=[].concat(o[0],l).join("?");new this.contentloader(this.$el,{url:e,target:this.$el,content:"aside",trigger:"immediate"})},reloadCollection:function(t){new this.contentloader(this.$el,{url:t+"&ajax_load=1",target:this.options.contentSelector,content:this.options.contentSelector,trigger:"immediate"});re=/@@.*\//,t=t.replace(re,""),window.history.replaceState({path:t},"",t)}})}),require(["jquery","pat-registry","collectionfilter"],function(t,e){"use strict";window.parent===window&&t(document).ready(function(){e.initialized||e.init()})}),define("/home/_thet/data/dev/aaf/aaf-buildout/src-addons/collective.collectionfilter/src/collective/collectionfilter/resources/collectionfilter-bundle.js",function(){});
//# sourceMappingURL=collectionfilter-compiled.js.map